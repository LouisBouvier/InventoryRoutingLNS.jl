<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Flows and Graphs · InventoryRoutingLNS.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://LouisBouvier.github.io/InventoryRoutingLNS.jl/flows/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">InventoryRoutingLNS.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../IRP/">Inventory Routing Problem</a></li><li><a class="tocitem" href="../input_output/">Input-Output</a></li><li><a class="tocitem" href="../evaluation/">Evaluation</a></li><li class="is-active"><a class="tocitem" href>Flows and Graphs</a><ul class="internal"><li><a class="tocitem" href="#FlowGraphs"><span>FlowGraphs</span></a></li><li><a class="tocitem" href="#Commodity-flow-graphs"><span>Commodity flow graphs</span></a></li><li><a class="tocitem" href="#Vehicle-flow-graphs"><span>Vehicle flow graphs</span></a></li></ul></li><li><a class="tocitem" href="../utils/">Utils</a></li><li><a class="tocitem" href="../localsearch/">Large Neighborhood Search</a></li><li><a class="tocitem" href="../heuristics/">Heuristics</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Flows and Graphs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Flows and Graphs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/main/docs/src/flows.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Graphs-and-flows"><a class="docs-heading-anchor" href="#Graphs-and-flows">Graphs and flows</a><a id="Graphs-and-flows-1"></a><a class="docs-heading-anchor-permalink" href="#Graphs-and-flows" title="Permalink"></a></h1><h2 id="FlowGraphs"><a class="docs-heading-anchor" href="#FlowGraphs">FlowGraphs</a><a id="FlowGraphs-1"></a><a class="docs-heading-anchor-permalink" href="#FlowGraphs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.FGN" href="#InventoryRoutingLNS.FGN"><code>InventoryRoutingLNS.FGN</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FGN</code></pre><p>A flow graph node represents a wide array of concepts to define flow graphs.</p><p>This structure is a central block of the <a href="#InventoryRoutingLNS.FlowGraph"><code>FlowGraph</code></a> used to build commodity and  vehicle flow graphs in <a href="#InventoryRoutingLNS.commodity_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>commodity_flow_graph</code></a> and <a href="#InventoryRoutingLNS.expanded_vehicle_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>expanded_vehicle_flow_graph</code></a> for instance.  </p><p><strong>Fields</strong></p><ul><li><code>t::Int</code>: date, by default 0.</li><li><code>t_h::Int</code>: hour (not used in current version), by default 0.</li><li><code>d::Int</code>: depot index, by default 0.</li><li><code>c::Int</code>: customer index, by default 0.</li><li><code>s::Int</code>: stop index, by default 0.</li><li><code>str::String</code>: <code>string</code> to mention a concept, by default &quot;?&quot;.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/graph_format.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.FlowGraph" href="#InventoryRoutingLNS.FlowGraph"><code>InventoryRoutingLNS.FlowGraph</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FlowGraph{L}</code></pre><p>Flow graph storage with labeled vertices and ordered edges that have capacities and costs.</p><p>This structure is used to build commodity and vehicle flow graphs in <a href="#InventoryRoutingLNS.commodity_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>commodity_flow_graph</code></a> and <a href="#InventoryRoutingLNS.expanded_vehicle_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>expanded_vehicle_flow_graph</code></a> for instance. It is based on the <code>Graph.jl</code> package.</p><p><strong>Fields</strong></p><ul><li><code>vertexlabels::Vector{L}</code>: vector of the vertex labels. </li><li><code>vertexindices::Dict{L,Int}</code>: correspondance between vertex labels and indices.</li><li><code>inneighbors::Vector{Vector{Int}}</code>: one vector of inneighbors indices per vertex index.</li><li><code>outneighbors::Vector{Vector{Int}}</code>: one vector of outneighbors indices per vertex index.</li><li><code>edges::Vector{Graphs.SimpleEdge{Int}}</code>: vector of edges.</li><li><code>edgeindices::Dict{Graphs.SimpleEdge{Int},Int}</code>: correspondance between edges and edgeindices.</li><li><code>capa_min::Vector{Float64}</code>: minimum capacity vector (on edges).</li><li><code>capa_max::Vector{Float64}</code>: maximum capacity vector (on edges).</li><li><code>cost::Vector{Float64}</code>: cost vector (on edges).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/graph_format.jl#L35-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_flow_constraints!-Tuple{JuMP.Model, Any, InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_flow_constraints!-Tuple{JuMP.Model, Any, InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_flow_constraints!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_flow_constraints!(model::Model, flowvar, g::FlowGraph)</code></pre><p>Add flow constraints to variable <code>flowvar</code> of a JuMP <code>model</code>, based on flow graph <code>g</code>.</p><p>The flow constraints are the following:</p><ul><li>minimum and maximum capacity constraints on all the arcs.</li><li>Kirchhoff constraint for the flow conservation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/graph_format.jl#L181-L189">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_flow_cost!-Tuple{Any, Any, InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_flow_cost!-Tuple{Any, Any, InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_flow_cost!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_flow_cost!(expr, flowvar, g::FlowGraph)</code></pre><p>Add flow cost of variable <code>flowvar</code> to JuMP expression <code>expr</code>, based on flow graph <code>g</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/graph_format.jl#L210-L214">source</a></section></article><h2 id="Commodity-flow-graphs"><a class="docs-heading-anchor" href="#Commodity-flow-graphs">Commodity flow graphs</a><a id="Commodity-flow-graphs-1"></a><a class="docs-heading-anchor-permalink" href="#Commodity-flow-graphs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_artificial_nodes_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_artificial_nodes_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_artificial_nodes_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_artificial_nodes_CFG!(fg::FlowGraph; refill_neighborhood::Bool)</code></pre><p>Add the artificial nodes to the commodity flow graph <code>fg</code>.</p><p>These artificial nodes are used to build a flow problem.</p><ul><li>The <code>source</code> and <code>sink</code> nodes enable a circulation.</li><li><code>production</code> is a way to model and force the value of depots release with capacitated arcs.</li><li><code>demand</code> does the same for the customers demand.</li><li><code>initial_inventory</code> enables to set the initial inventory at each depot and each customer.</li><li><code>shortage_compensation</code> is a way to model the shortage costs in the flow.</li><li><code>final_inventory</code> gathers the inventory at each site in the end of the horizon <code>T</code>.</li><li><code>other_received_quantities</code> and <code>other_sent_quantities</code> are only created    when the boolean <code>refill_neighborhood</code> is <code>true</code>. This is done when defining    a large neighborhood MILP with <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_customer_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_customer_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_customer_inventory_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_customer_inventory_arcs_CFG!(fg::FlowGraph;
                                    instance::Instance,
                                    commodity_index::Int,
                                    list_customers::AbstractVector{Int},
                                    S_max::Int,
)</code></pre><p>Add the arcs corresponding to the customers inventory dynamics.</p><p>Thanks to the <code>free_night</code> nodes we manage to model the excess inventory costs. We create on each day:</p><ul><li>one arc from <code>morning</code> to <code>evening</code> without cost or capacity.</li><li>one arc from <code>evening</code> to <code>free_night</code> with cost or capacity.</li><li>one arc from <code>evening</code> to <code>morning</code> of next day with unit <code>excess_inventory_cost</code> and no capacity.</li><li>one arc from <code>free_night</code> to <code>morning</code> of next day with capacity <code>maximum_inventory</code>.</li><li>one arc from each <code>noon</code> node to <code>evening</code> to connect the possible positions in new    routes with the inventory dynamics.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L285-L303">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_cycle_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph, Bool}" href="#InventoryRoutingLNS.add_cycle_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph, Bool}"><code>InventoryRoutingLNS.add_cycle_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_cycle_arcs_CFG!(fg::FlowGraph, refill_neighborhood::Bool)</code></pre><p>Add the arcs between artificial nodes to create the circulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L638-L642">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_depots_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_depots_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_depots_inventory_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_depots_inventory_arcs_CFG!(fg::FlowGraph;
                                instance::Instance,
                                commodity_index::Int,
                                list_depots::AbstractVector{Int},
)</code></pre><p>Add the arcs corresponding to the depots inventory dynamics.</p><p>Thanks to the <code>free_night</code> nodes we manage to model the excess inventory costs. We create on each day:</p><ul><li>one arc from <code>morning</code> to <code>evening</code> without cost or capacity.</li><li>one arc from <code>evening</code> to <code>free_night</code> with cost or capacity.</li><li>one arc from <code>evening</code> to <code>morning</code> of next day with unit <code>excess_inventory_cost</code> and no capacity.</li><li>one arc from <code>free_night</code> to <code>morning</code> of next day with capacity <code>maximum_inventory</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L240-L255">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_every_day_nodes_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_every_day_nodes_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_every_day_nodes_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_every_day_nodes_CFG!(fg::FlowGraph;
                            instance::Instance,
                            list_depots::AbstractVector{Int},
                            list_customers::AbstractVector{Int},
                            S_max::Int,
)</code></pre><p>Add the daily inventory nodes to the commodity flow graph.</p><p>We update <code>fg</code> with new nodes:</p><ul><li>One <code>morning</code> and <code>evening</code> node on each day <code>t</code> for each site.   We remind that demand, release and routes departures occur in the morning,   whereas routes arrival in the evening. </li><li>One <code>free_night</code> node on each day to incorporate the excess inventory costs.</li><li>One <code>noon</code> node for each position in a new route for the customers.   Most of the time <code>S_max</code> is <code>1</code>(in this function, not in <code>instance</code> data) and only one    position is considered: in this case we plan to build new direct routes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L36-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_fixed_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_fixed_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_fixed_routes_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_fixed_routes_arcs_CFG!(fg::FlowGraph;
                            instance::Instance,
                            fixed_routes::Vector{Route},
                            commodity_index::Int,
                            force_routes_values::Bool,
)</code></pre><p>Add the arcs corresponding to the <code>fixed_routes</code> paths.</p><p>This function is used to integrate some routes with pre-defined  paths in the flow solution. We add the nodes and arcs corresponding  to those paths, and connect them to the starting depots and to the  evening of the customers visited.  It is particularly useful in <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L564-L579">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_initial_final_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_initial_final_inventory_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_initial_final_inventory_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_initial_final_inventory_arcs_CFG!(fg::FlowGraph;
                                        instance::Instance,
                                        commodity_index::Int,
                                        list_depots::AbstractVector{Int},
                                        list_customers::AbstractVector{Int},
)</code></pre><p>Add arcs between the artificial nodes and initial and final inventory nodes.</p><p>The arcs from <code>initial_inventory</code> to the morning of the first day are used to set the initial inventories to the values stored in <code>instance</code>.  The final inventories are aggregated for clarity and could be used to add final  inventory costs for instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L96-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_new_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_new_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_new_routes_arcs_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_new_routes_arcs_CFG!(fg::FlowGraph;
                            instance::Instance,
                            list_depots::AbstractVector{Int},
                            list_customers::AbstractVector{Int},
                            commodity_index::Int,
                            maxdist::Real,
                            relaxed_trip_cost::Bool,
                            average_content_sizes::Union{Nothing,AverageContentSizes},
                            S_max::Int,
                            force_routes_values::Bool,
                            sent_quantities_to_force::Array,
                            set_upper_capa::Bool,
                            possible_delays::Dict,
                            add_delayed_arcs::Bool,
)</code></pre><p>Add the arcs corresponding to new routes.</p><p>The <code>maxdist</code> argument is used to sparsify the graph, removing arcs corresponding to long distances. </p><p>When the boolean <code>relaxed_trip_cost</code> is <code>true</code>, we add costs on  the routing arcs of the commodity flow graphs. This is done in a heurisic  way in <a href="../heuristics/#InventoryRoutingLNS.initialization_plus_ls!-Tuple{InventoryRoutingLNS.Instance}"><code>initialization_plus_ls!</code></a> with vehicle fraction costs, and based on  the statistics (saved in <code>average_content_sizes</code>) of a first solution  in a second pass in <a href="../heuristics/#InventoryRoutingLNS.modified_capa_initialization_plus_ls!-Tuple{InventoryRoutingLNS.Instance}"><code>modified_capa_initialization_plus_ls!</code></a>. When used in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_commodity!-Tuple{InventoryRoutingLNS.Instance}"><code>one_step_ruin_recreate_commodity!</code></a> or <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>,  no cost is set on those routing arcs of the commodity flow graphs.</p><p>We enable forcing the quantities to send through the routes with the boolean <code>force_routes_values</code> and quantities <code>sent_quantities_to_force</code>.  This is done to initialize the flow solution with the value deduced from  the current IRP <code>solution</code>, to speed-up computations. This is done in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_commodity!-Tuple{InventoryRoutingLNS.Instance}"><code>one_step_ruin_recreate_commodity!</code></a>.</p><p>For some applications in Machine Learning, we need to define a flow  on a polytope (bounded) and thus to derive some upper capacities  on the routing arcs. This is done when <code>set_upper_capa</code> is <code>true</code>.</p><p>Last, to derive a flow relaxation of the IRP, we need to add  delayed arcs in the commodity flow graphs, which is done when  <code>add_delayed_arcs</code> is <code>true</code>. In this case the direct delayed arcs  have precomputed delays saved in <code>possible_delays</code>. The implementation of the relaxation is done in <a href="../heuristics/#InventoryRoutingLNS.lower_bound-Tuple{InventoryRoutingLNS.Instance}"><code>lower_bound</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L351-L396">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_production_arcs_depots_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_production_arcs_depots_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_production_arcs_depots_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_production_arcs_depots_CFG!(fg::FlowGraph;
                                instance::Instance,
                                commodity_index::Int,
                                list_depots::AbstractVector{Int},
                                refill_neighborhood::Bool,
)</code></pre><p>Add the arcs corresponding to release and quantities to send to other customers.</p><p>We use the arcs from <code>production</code> to the morning of each day to set the release of each customer in accordance with the data stored in <code>instance</code>. Besides, since we possibly fix a part of the solution when <code>refill_neighborhood</code> is <code>true</code>,  the arcs to <code>other_sent_quantities</code> nodes are used to take the  other deliveries into account in the inventory dynamics of the depots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L148-L163">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFG!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_shortage_demand_arcs_customer_CFG!(fg::FlowGraph;
                                        instance::Instance,
                                        commodity_index::Int,
                                        list_customers::AbstractVector{Int},
                                        refill_neighborhood::Bool,
)</code></pre><p>Add the arcs corresponding to demand, shortage and quantities received.</p><p>As for the release, the arcs from each morning to the node <code>demand</code> are used to fix the demand in accordance with the data of <code>instance</code>. Besides, we create arcs from the node <code>shortage_compensation</code> to each morning  node with shortage cost to model the soft minimum inventory constraint.  Last, when <code>refill_neighborhood</code> is <code>true</code>, we also create arcs from <code>other_received_quantities</code> to morning nodes to take the rest of the current solution into account.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L190-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.commodity_flow_graph-Tuple{InventoryRoutingLNS.Instance}" href="#InventoryRoutingLNS.commodity_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>InventoryRoutingLNS.commodity_flow_graph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">commodity_flow_graph(instance::Instance;
                        commodity_index::Int,
                        add_new_routes_arcs::Bool = true,
                        S_max::Int = 1,
                        maxdist::Real = Inf,
                        relaxed_trip_cost::Bool = true,
                        average_content_sizes::Union{Nothing,AverageContentSizes} = nothing,
                        force_routes_values::Bool = false,
                        sent_quantities_to_force::Array = zeros(1),
                        sparsify::Bool = true,
                        set_upper_capa::Bool = false,
                        possible_delays::Dict = Dict(),
                        add_delayed_arcs::Bool = false,
                        fixed_routes::Union{Nothing, Vector{Route}} = nothing,
                        refill_neighborhood::Bool = false,
)</code></pre><p>Create the commodity flow graph corresponding to <code>commodity_index</code>.</p><p>When <code>add_new_routes_arcs</code> is <code>true</code>, we add the arcs corresponding to new  routes with <a href="#InventoryRoutingLNS.add_new_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>add_new_routes_arcs_CFG!</code></a>.</p><p>The argument <code>S_max</code> is used to restrict the length of the new routes to create. It is currently systematically set to <code>1</code>. See <a href="../heuristics/#InventoryRoutingLNS.initialization_plus_ls!-Tuple{InventoryRoutingLNS.Instance}"><code>initialization_plus_ls!</code></a> and  <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_commodity!-Tuple{InventoryRoutingLNS.Instance}"><code>one_step_ruin_recreate_commodity!</code></a> for instance. </p><p>The <code>maxdist</code> argument is used to sparsify the graph, removing arcs corresponding to long distances.</p><p>When <code>sparsify</code> is <code>true</code>, we restrict the nodes to the customers and depots that are concerned by the commodity with index <code>commodity_index</code>. We emphasize in this  case the indices of the nodes and arcs differ from one commodity flow graph to  the other, which makes it difficult to combine them for instance in  <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>. We may thus disable this sparsification  and force zero values in this case. </p><p>When the boolean <code>relaxed_trip_cost</code> is <code>true</code>, we add costs on  the routing arcs of the commodity flow graphs. This is done in a heurisic  way in <a href="../heuristics/#InventoryRoutingLNS.initialization_plus_ls!-Tuple{InventoryRoutingLNS.Instance}"><code>initialization_plus_ls!</code></a> with vehicle fraction costs, and based on  the statistics (saved in <code>average_content_sizes</code>) of a first solution  in a second pass in <a href="../heuristics/#InventoryRoutingLNS.modified_capa_initialization_plus_ls!-Tuple{InventoryRoutingLNS.Instance}"><code>modified_capa_initialization_plus_ls!</code></a>. When used in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_commodity!-Tuple{InventoryRoutingLNS.Instance}"><code>one_step_ruin_recreate_commodity!</code></a> or <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>,  no cost is set on those routing arcs of the commodity flow graphs.</p><p>We enable forcing the quantities to send through the routes with the boolean <code>force_routes_values</code> and quantities <code>sent_quantities_to_force</code>.  This is done to initialize the flow solution with the value deduced from  the current IRP <code>solution</code>, to speed-up computations. This is done in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_commodity!-Tuple{InventoryRoutingLNS.Instance}"><code>one_step_ruin_recreate_commodity!</code></a>.</p><p>For some applications in Machine Learning, we need to define a flow  on a polytope (bounded) and thus to derive some upper capacities  on the routing arcs. This is done when <code>set_upper_capa</code> is <code>true</code>.</p><p>To derive a flow relaxation of the IRP, we need to add  delayed arcs in the commodity flow graphs, which is done when  <code>add_delayed_arcs</code> is <code>true</code>. In this case the direct delayed arcs  have precomputed delays saved in <code>possible_delays</code>. The implementation of the relaxation is done in <a href="../heuristics/#InventoryRoutingLNS.lower_bound-Tuple{InventoryRoutingLNS.Instance}"><code>lower_bound</code></a>. </p><p>Last, as stated before, this graph structure can be used and combined  in the <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a> function, possibly to derive  a large neighborhood when the boolean <code>refill_neighborhood</code> is <code>true</code>. In this case we provide the <code>fixed_routes</code> to add in <a href="#InventoryRoutingLNS.add_fixed_routes_arcs_CFG!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>add_fixed_routes_arcs_CFG!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph.jl#L660-L725">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_artificial_nodes_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_artificial_nodes_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_artificial_nodes_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_artificial_nodes_CFGC!(fg::FlowGraph)</code></pre><p>Add the artificial nodes to the commodity flow graph <code>fg</code> of a customer.</p><p>These artificial nodes are used to build a flow problem.</p><ul><li>The <code>source</code> and <code>sink</code> nodes enable a circulation.</li><li><code>production</code> is a way to model and force the value of depots release with capacitated arcs.</li><li><code>demand</code> does the same for the customers demand.</li><li><code>initial_inventory</code> enables to set the initial inventory at each depot and each customer.</li><li><code>shortage_compensation</code> is a way to model the shortage costs in the flow.</li><li><code>delivery_other_customers</code> enables to fix the quantities to be sent by depots to other customers than the one being inserted.</li><li><code>final_inventory</code> gathers the inventory at each site in the end of the horizon <code>T</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_customer_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_customer_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_customer_inventory_arcs_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_customer_inventory_arcs_CFGC!(fg::FlowGraph;
                                    instance::Instance,
                                    customer_index::Int,
                                    commodity_index::Int,
)</code></pre><p>Add the arcs corresponding to the customer <code>customer_index</code> inventory dynamics.</p><p>Thanks to the <code>free_night</code> nodes we manage to model the excess inventory costs. We create on each day:</p><ul><li>one arc from <code>morning</code> to <code>evening</code> without cost or capacity.</li><li>one arc from <code>evening</code> to <code>free_night</code> with cost or capacity.</li><li>one arc from <code>evening</code> to <code>morning</code> of next day with unit <code>excess_inventory_cost</code> and no capacity.</li><li>one arc from <code>free_night</code> to <code>morning</code> of next day with capacity <code>maximum_inventory</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L270-L285">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_cycle_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_cycle_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_cycle_arcs_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_cycle_arcs_CFGC!(fg::FlowGraph)</code></pre><p>Add the arcs between artificial nodes to create the circulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L405-L409">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_depots_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_depots_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_depots_inventory_arcs_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_depots_inventory_arcs_CFGC!(fg::FlowGraph;
                                instance::Instance,
                                commodity_index::Int,
)</code></pre><p>Add the arcs corresponding to the depots inventory dynamics.</p><p>Thanks to the <code>free_night</code> nodes we manage to model the excess inventory costs. We create on each day:</p><ul><li>one arc from <code>morning</code> to <code>evening</code> without cost or capacity.</li><li>one arc from <code>evening</code> to <code>free_night</code> with cost or capacity.</li><li>one arc from <code>evening</code> to <code>morning</code> of next day with unit <code>excess_inventory_cost</code> and no capacity.</li><li>one arc from <code>free_night</code> to <code>morning</code> of next day with capacity <code>maximum_inventory</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L226-L240">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_every_day_nodes_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_every_day_nodes_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_every_day_nodes_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_every_day_nodes_CFGC!(fg::FlowGraph;
                            instance::Instance,
                            customer_index::Int,
                            routes::Vector{Route},
                            dates::Vector,
                            costs::Vector,    
)</code></pre><p>Add the daily inventory nodes to the commodity flow graph of a customer.</p><p>We update <code>fg</code> with new nodes:</p><ul><li>One <code>morning</code> and <code>evening</code> node on each day <code>t</code> for each site. We remind that demand,    release and routes departures occur in the morning, whereas routes arrival in the evening. </li><li>One <code>free_night</code> node on each day to incorporate the excess inventory costs.</li><li>One node per possible position of the customer to insert in the <code>routes</code>.    This means saving the arrival dates for each position in <code>dates</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L30-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_initial_final_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_initial_final_inventory_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_initial_final_inventory_arcs_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_initial_final_inventory_arcs_CFGC!(fg::FlowGraph;
                                        instance::Instance,
                                        customer_index::Int,
                                        commodity_index::Int,
)</code></pre><p>Add arcs between the artificial nodes and initial and final inventory nodes.</p><p>The arcs from <code>initial_inventory</code> to the morning of the first day are used to set the initial inventories to the values stored in <code>instance</code>.  The final inventories are aggregated for clarity and could be used to add final  inventory costs for instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L88-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_production_delivery_arcs_depots_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_production_delivery_arcs_depots_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_production_delivery_arcs_depots_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_production_delivery_arcs_depots_CFGC!(fg::FlowGraph;
                                            instance::Instance,
                                            commodity_index::Int,
)</code></pre><p>Add the arcs corresponding to release and quantities to send to other customers.</p><p>We use the arcs from <code>production</code> to the morning of each day to set the release of each customer in accordance with the data stored in <code>instance</code>. Besides, since we fix a part of the solution when optimizing the reinsertion of  one customer, the arcs to <code>delivery_other_customers</code> nodes are used to take the  other deliveries into account in the inventory dynamics of the depots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L141-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_routes_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_routes_arcs_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_routes_arcs_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_routes_arcs_CFGC!(fg::FlowGraph;
                        instance::Instance,
                        customer_index::Int,
                        commodity_index::Int, 
                        routes::Vector{Route},
                        dates::Vector,
                        costs::Vector,
                        force_values::Bool,
                        former_quantities_former_routes::Dict, 
                        former_quantities_new_routes::Array,
)</code></pre><p>Add the arcs corresponding to the <code>routes</code> paths.</p><p>Two types of routes are represented:</p><ul><li>new direct ones from depots to the customer with <code>customer_index</code>.</li><li>old routes with each possible position of the customer for reinsertion.   The (routing + other customers inventories and shortage) costs induced by    the reinsertion at each position are precomputed and stored in <code>costs</code>.   The dates of arrival at each reinsertion position are also precomputed    and stored in <code>dates</code>.</li></ul><p>We enable forcing the quantities to send through the routes with the boolean <code>force_values</code> and quantities <code>former_quantities_former_routes</code> and  <code>former_quantities_new_routes</code>. This is done to initialize the flow solution with the value deduced from the current IRP <code>solution</code>, to speed-up computations. This is done in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_customer!-Tuple{InventoryRoutingLNS.Instance, Int64}"><code>one_step_ruin_recreate_customer!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L325-L352">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}" href="#InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFGC!-Tuple{InventoryRoutingLNS.FlowGraph}"><code>InventoryRoutingLNS.add_shortage_demand_arcs_customer_CFGC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_shortage_demand_arcs_customer_CFGC!(fg::FlowGraph;
                                        instance::Instance,
                                        customer_index::Int,
                                        commodity_index::Int,
)</code></pre><p>Add the arcs corresponding to demand and shortage.</p><p>As for the release, the arcs from each morning to the node <code>demand</code> are used to fix the demand in accordance with the data of <code>instance</code>. Besides, we create arcs from the node <code>shortage_compensation</code> to each morning  node with shortage cost to model the soft minimum inventory constraint. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L179-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.commodity_flow_graph_customer-Tuple{InventoryRoutingLNS.Instance}" href="#InventoryRoutingLNS.commodity_flow_graph_customer-Tuple{InventoryRoutingLNS.Instance}"><code>InventoryRoutingLNS.commodity_flow_graph_customer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">commodity_flow_graph_customer(instance::Instance;
                                customer_index::Int,
                                commodity_index::Int,
                                routes::Vector{Route},
                                dates::Vector,
                                costs::Vector,
                                force_values::Bool = false,
                                former_quantities_former_routes::Dict = Dict(), 
                                former_quantities_new_routes::Array = zeros(1),
)</code></pre><p>Create the commodity flow graph corresponding to <code>commodity_index</code> for the reinsertion of  the customer with index <code>customer_index</code>.</p><p>The (routing + other customers inventories and shortage) costs induced by  the reinsertion at each position are precomputed and stored in <code>costs</code>. The dates of arrival at each reinsertion position are also precomputed  and stored in <code>dates</code>. We enable forcing the quantities to send through the routes with the boolean <code>force_values</code> and quantities <code>former_quantities_former_routes</code> and  <code>former_quantities_new_routes</code>. This is done to initialize the flow solution with the value deduced from the current IRP <code>solution</code>, to speed-up computations. This is done in <a href="../localsearch/#InventoryRoutingLNS.one_step_ruin_recreate_customer!-Tuple{InventoryRoutingLNS.Instance, Int64}"><code>one_step_ruin_recreate_customer!</code></a>. The flowgraph is based on the structure <a href="#InventoryRoutingLNS.FlowGraph"><code>FlowGraph</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/commodity_graph_single_customer.jl#L422-L447">source</a></section></article><h2 id="Vehicle-flow-graphs"><a class="docs-heading-anchor" href="#Vehicle-flow-graphs">Vehicle flow graphs</a><a id="Vehicle-flow-graphs-1"></a><a class="docs-heading-anchor-permalink" href="#Vehicle-flow-graphs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.expanded_vehicle_flow_graph-Tuple{InventoryRoutingLNS.Instance}" href="#InventoryRoutingLNS.expanded_vehicle_flow_graph-Tuple{InventoryRoutingLNS.Instance}"><code>InventoryRoutingLNS.expanded_vehicle_flow_graph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">expanded_vehicle_flow_graph(instance::Instance; 
                                add_new_routes_arcs::Bool = true,
                                S_max::Int, 
                                maxdist::Real = Inf,
                                fixed_routes::Union{Nothing, Vector{Route}} = nothing,
                                fixed_routes_costs::Union{Nothing, Vector{Int}} = nothing,
)</code></pre><p>Create a vehicles&#39; flow graph with old fixed and new routes.</p><p>This function is called to derive the commodity reinsertion MILP in <a href="../localsearch/#InventoryRoutingLNS.commodity_insertion_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>commodity_insertion_MILP</code></a> as well as the MILP to refill  fixed routes in <a href="../heuristics/#InventoryRoutingLNS.fill_fixed_routes_MILP-Tuple{InventoryRoutingLNS.Instance}"><code>fill_fixed_routes_MILP</code></a>.</p><p>Two types of routes are represented:</p><ul><li>new direct ones from depots to customers, added when <code>add_new_routes_arcs</code> is <code>true</code>.   When creating new routes, the argument <code>maxdist</code> may be used to sparsify the graph    by removing arcs with long distances. The maximum length of new routes is defined    by <code>S_max</code>, which is possibly distinct from the value of <code>instance.S_max</code>.</li><li>old <code>fixed_routes</code> that visit several stops, with corresponding costs <code>fixed_routes_costs</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/truck_graph.jl#L2-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InventoryRoutingLNS.expanded_vehicle_flow_graph_customer-Tuple{InventoryRoutingLNS.Instance}" href="#InventoryRoutingLNS.expanded_vehicle_flow_graph_customer-Tuple{InventoryRoutingLNS.Instance}"><code>InventoryRoutingLNS.expanded_vehicle_flow_graph_customer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">expanded_vehicle_flow_graph_customer(instance::Instance;
                                        customer_index::Int,
                                        routes::Vector{Route},
                                        cost_per_route::Vector,
                                        dates::Vector,
)</code></pre><p>Create the vehicles&#39; flow graph of a customer indexed by <code>customer_index</code>.</p><p>This function is called to derive the customer reinsertion MILP in <a href="../localsearch/#InventoryRoutingLNS.customer_insertion_flow-Tuple{InventoryRoutingLNS.Instance}"><code>customer_insertion_flow</code></a>.</p><p>Two types of routes are represented:</p><ul><li>new direct ones from depots to the customer with <code>customer_index</code>.</li><li>old <code>routes</code> with each possible position of the customer for reinsertion.   The (routing + other customers inventories and shortage) costs induced by    the reinsertion at each position are precomputed and stored in <code>cost_per_route</code>.   The dates of arrival at each reinsertion position are also precomputed    and stored in <code>dates</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LouisBouvier/InventoryRoutingLNS.jl/blob/bc7209e03bdbf407661f303c6a71b916ba2613ed/src/flows/truck_graph_single_customer.jl#L3-L23">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../evaluation/">« Evaluation</a><a class="docs-footer-nextpage" href="../utils/">Utils »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 7 October 2022 06:56">Friday 7 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
